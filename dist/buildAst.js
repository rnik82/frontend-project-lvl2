"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _lodash = _interopRequireDefault(require("lodash"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const buildAst = (data1, data2) => {
  const keys1 = Object.keys(data1);
  const keys2 = Object.keys(data2);

  const commonKeys = _lodash.default.uniq(keys1.concat(keys2));

  const result = commonKeys.map(key => {
    const value1 = data1[key];
    const value2 = data2[key];

    if (_lodash.default.has(data1, key) && _lodash.default.has(data2, key)) {
      if (_lodash.default.isObject(value1) && _lodash.default.isObject(value2)) {
        return {
          status: 'unchanged',
          key,
          children: buildAst(value1, value2)
        };
      }

      if (value1 !== value2) {
        return {
          status: 'changed',
          key,
          value: value1,
          value2
        };
      }

      return {
        status: 'unchanged',
        key,
        value: value1
      };
    }

    if (_lodash.default.has(data1, key) && !_lodash.default.has(data2, key)) {
      return {
        status: 'deleted',
        key,
        value: value1
      };
    }

    if (!_lodash.default.has(data1, key) && _lodash.default.has(data2, key)) {
      return {
        status: 'added',
        key,
        value: value2
      };
    }
  });
  return result;
};

var _default = buildAst;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9idWlsZEFzdC5qcyJdLCJuYW1lcyI6WyJidWlsZEFzdCIsImRhdGExIiwiZGF0YTIiLCJrZXlzMSIsIk9iamVjdCIsImtleXMiLCJrZXlzMiIsImNvbW1vbktleXMiLCJfIiwidW5pcSIsImNvbmNhdCIsInJlc3VsdCIsIm1hcCIsImtleSIsInZhbHVlMSIsInZhbHVlMiIsImhhcyIsImlzT2JqZWN0Iiwic3RhdHVzIiwiY2hpbGRyZW4iLCJ2YWx1ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOzs7O0FBRUEsTUFBTUEsUUFBUSxHQUFHLENBQUNDLEtBQUQsRUFBUUMsS0FBUixLQUFrQjtBQUUvQixRQUFNQyxLQUFLLEdBQUdDLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZSixLQUFaLENBQWQ7QUFDQSxRQUFNSyxLQUFLLEdBQUdGLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZSCxLQUFaLENBQWQ7O0FBRUEsUUFBTUssVUFBVSxHQUFHQyxnQkFBRUMsSUFBRixDQUFPTixLQUFLLENBQUNPLE1BQU4sQ0FBYUosS0FBYixDQUFQLENBQW5COztBQUVBLFFBQU1LLE1BQU0sR0FBR0osVUFBVSxDQUFDSyxHQUFYLENBQWdCQyxHQUFELElBQVM7QUFDckMsVUFBTUMsTUFBTSxHQUFHYixLQUFLLENBQUNZLEdBQUQsQ0FBcEI7QUFDQSxVQUFNRSxNQUFNLEdBQUdiLEtBQUssQ0FBQ1csR0FBRCxDQUFwQjs7QUFDQSxRQUFJTCxnQkFBRVEsR0FBRixDQUFNZixLQUFOLEVBQWFZLEdBQWIsS0FBcUJMLGdCQUFFUSxHQUFGLENBQU1kLEtBQU4sRUFBYVcsR0FBYixDQUF6QixFQUE0QztBQUMxQyxVQUFJTCxnQkFBRVMsUUFBRixDQUFXSCxNQUFYLEtBQXNCTixnQkFBRVMsUUFBRixDQUFXRixNQUFYLENBQTFCLEVBQThDO0FBQzVDLGVBQU87QUFBRUcsVUFBQUEsTUFBTSxFQUFFLFdBQVY7QUFBdUJMLFVBQUFBLEdBQXZCO0FBQTRCTSxVQUFBQSxRQUFRLEVBQUVuQixRQUFRLENBQUNjLE1BQUQsRUFBU0MsTUFBVDtBQUE5QyxTQUFQO0FBQ0Q7O0FBQ0QsVUFBSUQsTUFBTSxLQUFLQyxNQUFmLEVBQXVCO0FBQ3JCLGVBQU87QUFBRUcsVUFBQUEsTUFBTSxFQUFFLFNBQVY7QUFBcUJMLFVBQUFBLEdBQXJCO0FBQTBCTyxVQUFBQSxLQUFLLEVBQUVOLE1BQWpDO0FBQXlDQyxVQUFBQTtBQUF6QyxTQUFQO0FBQ0Q7O0FBQ0QsYUFBTztBQUFFRyxRQUFBQSxNQUFNLEVBQUUsV0FBVjtBQUF1QkwsUUFBQUEsR0FBdkI7QUFBNEJPLFFBQUFBLEtBQUssRUFBRU47QUFBbkMsT0FBUDtBQUNEOztBQUNELFFBQUlOLGdCQUFFUSxHQUFGLENBQU1mLEtBQU4sRUFBYVksR0FBYixLQUFxQixDQUFDTCxnQkFBRVEsR0FBRixDQUFNZCxLQUFOLEVBQWFXLEdBQWIsQ0FBMUIsRUFBNkM7QUFDM0MsYUFBTztBQUFFSyxRQUFBQSxNQUFNLEVBQUUsU0FBVjtBQUFxQkwsUUFBQUEsR0FBckI7QUFBMEJPLFFBQUFBLEtBQUssRUFBRU47QUFBakMsT0FBUDtBQUNEOztBQUNELFFBQUksQ0FBQ04sZ0JBQUVRLEdBQUYsQ0FBTWYsS0FBTixFQUFhWSxHQUFiLENBQUQsSUFBc0JMLGdCQUFFUSxHQUFGLENBQU1kLEtBQU4sRUFBYVcsR0FBYixDQUExQixFQUE2QztBQUMzQyxhQUFPO0FBQUVLLFFBQUFBLE1BQU0sRUFBRSxPQUFWO0FBQW1CTCxRQUFBQSxHQUFuQjtBQUF3Qk8sUUFBQUEsS0FBSyxFQUFFTDtBQUEvQixPQUFQO0FBQ0M7QUFDRixHQWxCWSxDQUFmO0FBbUJBLFNBQU9KLE1BQVA7QUFDRCxDQTNCSDs7ZUE2QmlCWCxRIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcblxuY29uc3QgYnVpbGRBc3QgPSAoZGF0YTEsIGRhdGEyKSA9PiB7XG5cbiAgICBjb25zdCBrZXlzMSA9IE9iamVjdC5rZXlzKGRhdGExKTtcbiAgICBjb25zdCBrZXlzMiA9IE9iamVjdC5rZXlzKGRhdGEyKTtcbiAgXG4gICAgY29uc3QgY29tbW9uS2V5cyA9IF8udW5pcShrZXlzMS5jb25jYXQoa2V5czIpKTtcbiAgXG4gICAgY29uc3QgcmVzdWx0ID0gY29tbW9uS2V5cy5tYXAoKGtleSkgPT4ge1xuICAgICAgY29uc3QgdmFsdWUxID0gZGF0YTFba2V5XTtcbiAgICAgIGNvbnN0IHZhbHVlMiA9IGRhdGEyW2tleV07XG4gICAgICBpZiAoXy5oYXMoZGF0YTEsIGtleSkgJiYgXy5oYXMoZGF0YTIsIGtleSkpIHtcbiAgICAgICAgaWYgKF8uaXNPYmplY3QodmFsdWUxKSAmJiBfLmlzT2JqZWN0KHZhbHVlMikpIHtcbiAgICAgICAgICByZXR1cm4geyBzdGF0dXM6ICd1bmNoYW5nZWQnLCBrZXksIGNoaWxkcmVuOiBidWlsZEFzdCh2YWx1ZTEsIHZhbHVlMil9O1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZTEgIT09IHZhbHVlMikge1xuICAgICAgICAgIHJldHVybiB7IHN0YXR1czogJ2NoYW5nZWQnLCBrZXksIHZhbHVlOiB2YWx1ZTEsIHZhbHVlMiB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHN0YXR1czogJ3VuY2hhbmdlZCcsIGtleSwgdmFsdWU6IHZhbHVlMX07XG4gICAgICB9XG4gICAgICBpZiAoXy5oYXMoZGF0YTEsIGtleSkgJiYgIV8uaGFzKGRhdGEyLCBrZXkpKSB7XG4gICAgICAgIHJldHVybiB7IHN0YXR1czogJ2RlbGV0ZWQnLCBrZXksIHZhbHVlOiB2YWx1ZTF9O1xuICAgICAgfVxuICAgICAgaWYgKCFfLmhhcyhkYXRhMSwga2V5KSAmJiBfLmhhcyhkYXRhMiwga2V5KSkge1xuICAgICAgICByZXR1cm4geyBzdGF0dXM6ICdhZGRlZCcsIGtleSwgdmFsdWU6IHZhbHVlMiB9O1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIGV4cG9ydCBkZWZhdWx0IGJ1aWxkQXN0O1xuICAiXX0=